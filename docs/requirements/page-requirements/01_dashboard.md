# ダッシュボードページ 設計書

## ページ概要
家計の全体的な状況を一目で把握できるメインページです。収支の推移、カテゴリ別支出、現在の財務状況をビジュアルに表示します。

## 主要機能

### コアビジネス機能
- **月別収支トレンド分析**: 過去6ヶ月の収支推移可視化
- **カテゴリ別支出分析**: 当月の支出構造把握
- **リアルタイム財務状況**: 現在の収支バランス表示
- **ナビゲーションハブ**: 他機能への効率的アクセス

### 1. ナビゲーション
- **サイドバー**: 画面左側に固定表示
- **メニュー項目**:
  - ダッシュボード
  - 取引
  - 予算
  - 資産
  - レポート
  - 設定

### 2. ユーザー情報
- **表示位置**: 画面右上
- **表示内容**: 
  - ユーザー名
  - プラン種別（Premium Plan等）

### 3. 収支トレンドグラフ
- **グラフタイプ**: 棒グラフ
- **表示期間**: 直近6ヶ月（デフォルト）
- **データ内容**:
  - 月別収入（緑色）
  - 月別支出（赤色）
- **期間切り替え機能**:
  - 1ヶ月: 直近1ヶ月の日別データ
  - 6ヶ月: 直近6ヶ月の月別データ（デフォルト）
  - 1年: 直近12ヶ月の月別データ
  - 全期間: ユーザー登録から現在までの全データ（月別表示）
- **表示形式の動的変更**:
  - 1ヶ月選択時: X軸が日付（日別表示）
  - 6ヶ月以上: X軸が月（月別表示）
  - 全期間選択時: X軸が年月（月別表示、年区切り）

### 4. カテゴリ別支出グラフ
- **グラフタイプ**: ドーナツチャート
- **表示内容**: 選択期間のカテゴリ別支出割合
- **期間連動**:
  - 1ヶ月: 当月のカテゴリ別支出
  - 6ヶ月: 直近6ヶ月のカテゴリ別合計支出
  - 1年: 直近12ヶ月のカテゴリ別合計支出
  - 全期間: 全期間のカテゴリ別合計支出
- **カテゴリ**: 
  - エンターテインメント
  - 食費
  - 交通費
  - 光熱費
  - 家賃・住居費
  - その他

### 5. サマリーカード
- **期間連動表示**:
  - 1ヶ月: 当月の収入・支出・純収入
  - 6ヶ月: 直近6ヶ月の合計収入・支出・純収入
  - 1年: 直近12ヶ月の合計収入・支出・純収入
  - 全期間: 全期間の合計収入・支出・純収入
- **表示内容**:
  - 収入: 選択期間の収入合計
  - 支出: 選択期間の支出合計
  - 純収入: 収入 - 支出
- **期間表示**: カードタイトルに選択中の期間を表示

## 対応API・テーブル・ドメイン情報

### 関連API
1. **GET /summary/monthly**
   - 月別収支サマリー取得（期間指定対応）
   - パラメータ: 
     - period: "1m" | "6m" | "1y" | "all"（表示期間）
     - granularity: "daily" | "monthly"（集計単位）
   - レスポンス: 期間と粒度に応じた収支データ

2. **GET /transactions/summary**
   - 取引サマリー取得（期間指定対応）
   - パラメータ:
     - period: "1m" | "6m" | "1y" | "all"
     - include_category_breakdown: true
   - レスポンス: 期間内のカテゴリ別集計、合計金額

3. **GET /categories**
   - カテゴリ一覧取得
   - グラフ表示用の色・アイコン情報を含む

4. **GET /users/me**
   - ユーザー基本情報取得（プロファイル表示用）

### 対応テーブル
- **transactions**: 取引データ（金額、日付、カテゴリ）
- **categories**: カテゴリ情報（名前、色、アイコン）
- **users**: ユーザー情報（名前、プラン情報）
- **recurring_transactions**: 定期取引（月末処理での自動取引生成）

### 関連ドメインエンティティ
- **Transaction集約**: 取引の作成・集計処理
- **Category集約**: カテゴリ管理・分類
- **User集約**: ユーザー情報・プラン管理
- **Summary集約**: レポート・サマリー生成

## 主要機能

### コアビジネス機能
- **柔軟な期間分析**: 1ヶ月から全期間までの柔軟な期間指定での収支トレンド分析
- **動的グラフ表示**: 期間に応じて日別・月別表示を自動切り替え
- **カテゴリ別支出分析**: 選択期間の支出構造把握と割合分析
- **リアルタイム財務状況**: 期間別の収支バランスと合計金額表示
- **ナビゲーションハブ**: 他機能への効率的アクセス

### 期間切り替え機能詳細
- **期間選択ボタン**: トレンドグラフ上部にタブ形式で配置
- **リアルタイム更新**: 期間切り替え時に即座にグラフとサマリーカードを更新
- **ローディングインジケータ**: データ読み込み中の表示
- **アニメーション**: グラフのスムーズな切り替えアニメーション

## UI/UX要件

### レスポンシブデザイン
- PC: フルレイアウト表示
- タブレット: グラフサイズ調整
- スマートフォン: 縦並び表示

### パフォーマンス
- 初期ロード: 3秒以内
- データ更新: リアルタイム反映

### アクセシビリティ
- グラフの代替テキスト提供
- キーボードナビゲーション対応
- スクリーンリーダー対応

## 実装優先順位
1. 基本レイアウト構築
2. 収支トレンドグラフ実装
3. カテゴリ別支出グラフ実装
4. サマリーカード実装
5. レスポンシブ対応

## 画面設計（ASCII）

```
+--------------------------------------------------------------------------------------------------+
|  FinSight                                                               AI User | Premium Plan    |
+----------------+---------------------------------------------------------------------------------+
| ≡ Dashboard    |                              Dashboard                                          |
|                |                                                                                 |
| 📊 Transactions |  Period: [1M] [6M] [1Y] [All]                                                  |
|                |                                                                                 |
| 💰 Budget       |  +----------------+  +----------------+  +----------------+                    |
|                |  | Current Period |  | Current Period |  | Net Income     |                    |
| 📈 Assets       |  | Income         |  | Expenses       |  |                |                    |
|                |  |                |  |                |  |                |                    |
| 📑 Reports      |  |   ¥250,000    |  |   ¥186,500    |  |   +¥63,500     |                    |
|                |  |                |  |                |  |                |                    |
| ⚙️ Settings     |  +----------------+  +----------------+  +----------------+                    |
|                |                                                                                 |
|                |  +------------------------------------------+  +----------------------------+ |
|                |  | Income/Expense Trends                    |  | Expense Category Breakdown | |
|                |  |                                          |  |                            | |
|                |  | 300K┤                                     |  |      Entertainment 25%     | |
|                |  |     |                                     |  |         ╱─────╲            | |
|                |  | 200K┤ ┌─┐   ┌─┐                          |  |     ╱───       ───╲        | |
|                |  |     | │█│ ┌─┤█│   ┌─┐   ┌─┐            |  |   │    Food 30%    │       | |
|                |  | 100K┤ │█│ │█│█│ ┌─┤█│ ┌─┤█│            |  |   │                │       | |
|                |  |     | │█│ │█│█│ │█│█│ │█│█│            |  |   │  Trans. 15%   │       | |
|                |  |    0┤─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─           |  |     ╲   Others   ╱        | |
|                |  |      Jun  Jul  Aug  Sep  Oct  Nov        |  |       ╲─── 10% ───╱        | |
|                |  |                                          |  |     Utilities 10%          | |
|                |  | █ Income  █ Expenses                    |  |      Household 10%         | |
|                |  +------------------------------------------+  +----------------------------+ |
|                |                                                                                 |
+----------------+---------------------------------------------------------------------------------+
```

### 画面要素説明

#### ヘッダー部
- 左側: ロゴ（FinSight）
- 右側: ユーザー名とプラン情報

#### サイドバー（左側）
- 幅: 200px固定
- アイコン付きメニュー項目
- 現在のページはハイライト表示

#### メインコンテンツエリア
1. **期間選択ボタン（上部）**
   - 4つのタブボタン: 1M, 6M, 1Y, All
   - 選択中の期間をハイライト表示

2. **サマリーカード（上部中央）**
   - 3つの等幅カード
   - 選択期間の収入、支出、純収入
   - 大きな数字で金額表示

3. **収支トレンドグラフ（左下）**
   - 期間に応じた棒グラフ
   - 緑: 収入、赤: 支出
   - X軸は期間に応じて動的変更

4. **カテゴリ別支出グラフ（右下）**
   - ドーナツチャート
   - 選択期間のカテゴリ別割合表示
   - ホバーで詳細金額表示