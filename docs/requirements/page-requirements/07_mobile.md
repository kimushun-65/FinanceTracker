# モバイルアプリ 設計書

## アプリ概要
今月の支出額表示、予算超過アラート、および簡単な取引入力に特化したシンプルなモバイルアプリです。

## 主要機能

### 1. 今月支出表示（メイン画面上部）
- **今月の支出総額**: 大きく表示
- **予算進捗バー**: 視覚的に予算消化状況を表示
- **残予算**: 「あと¥XX,XXX」と表示
- **予算超過アラート**: 
  - 80%超過時: 黄色警告
  - 90%超過時: オレンジ警告
  - 100%超過時: 赤色警告と「予算超過」メッセージ

### 2. 取引入力（メイン画面下部）
- **金額入力**:
  - テンキーパッド
  - 入力中の金額をリアルタイム表示
  - クリアボタン
- **カテゴリ選択**:
  - シンプルなドロップダウン
  - 使用中のカテゴリのみ表示
- **日付**:
  - デフォルトは今日
  - タップで日付変更可能
- **メモ（オプション）**:
  - 簡単なテキスト入力
- **保存ボタン**: 
  - 大きく目立つボタン
  - 保存後は入力をクリア

## 画面構成

シンプルな単一画面構成：
- **メイン画面**: 支出表示と入力機能が一体化
- **設定**: Web版へのリンクのみ

## 対応API・テーブル・ドメイン情報

### 関連API
1. **POST /transactions**
   - 取引作成
   - リクエスト: type("expense")、amount、category_id、transaction_date、description(オプション)
   - レスポンス: 作成された取引情報

2. **GET /transactions/summary/monthly**
   - 今月の支出総額取得
   - パラメータ: year、month（省略時は当月）
   - レスポンス: total_expenses、total_income

3. **GET /budgets/current**
   - 今月の予算情報取得
   - レスポンス: total_budget、spent_amount、remaining_budget、progress_percentage

4. **GET /categories**
   - アクティブなカテゴリ一覧取得（自動的にis_active=trueのみ）
   - レスポンス: id、name、icon

### 対応テーブル
- **transactions**: 取引データ
- **categories**: カテゴリマスタ（使用中のみ）
- **budgets**: 予算データ（進捗計算用）

## UI/UX要件

### 操作性
- **片手操作**: 画面下部にテンキー配置
- **大きなタップエリア**: 44pt以上
- **触覚フィードバック**: 入力確定時

### パフォーマンス
- **起動時間**: 1秒以内
- **入力レスポンス**: 即座に反映
- **API通信**: 非同期でUIをブロックしない

## プラットフォーム別仕様

### iOS
- **最小バージョン**: iOS 14.0以上
- **フレームワーク**: SwiftUI
- **データ保存**: Core Data
- **通知**: Push Notification
- **生体認証**: Face ID/Touch ID

### Android
- **最小バージョン**: Android 6.0以上
- **フレームワーク**: Jetpack Compose
- **データ保存**: Room
- **通知**: Firebase Cloud Messaging
- **生体認証**: BiometricPrompt

## セキュリティ要件

### 認証
- **OAuth 2.0**: Auth0経由でのGoogle認証
- **トークン管理**: アクセストークンの安全な保存

### データ保護
- **通信暗号化**: HTTPS通信
- **キーチェーン/キーストア**: 認証情報保存

## 実装優先順位
1. 今月支出表示と予算アラート
2. 基本的な取引入力機能
3. API連携とデータ同期

## 画面設計（ASCII）

```
┌─────────────────────────┐
│ 📱 FinSight      19:30  │
├─────────────────────────┤
│                         │
│  今月の支出              │
│                         │
│     ¥ 88,237           │
│                         │
│  ━━━━━━━━━━━━━━━━━━━━━━  │
│  ██████████████████░░░░  │
│  ━━━━━━━━━━━━━━━━━━━━━━  │
│                         │
│   あと ¥11,763          │
│  (予算：¥100,000)      │
│                         │
├─────────────────────────┤
│  ⚠️ 予算の88%消化済み     │  
├─────────────────────────┤
│                         │
│  ┌───┬───┬───┐         │
│  │ 7 │ 8 │ 9 │         │
│  ├───┼───┼───┤         │
│  │ 4 │ 5 │ 6 │         │
│  ├───┼───┼───┤         │
│  │ 1 │ 2 │ 3 │         │
│  ├───┼───┼───┤         │
│  │ 0 │ . │ ← │         │
│  └───┴───┴───┘         │
│                         │
│ カテゴリ:                │
│ ┌─────────────────────┐ │
│ │ 🍎 食費         ▼  │ │
│ └─────────────────────┘ │
│                         │
│ メモ (任意):             │
│ ┌─────────────────────┐ │
│ │ ランチ_              │ │
│ └─────────────────────┘ │
│                         │
│ ┌─────────────────────┐ │
│ │      保存          │ │
│ └─────────────────────┘ │
│                         │
└─────────────────────┘
```

### 画面要素説明

#### 今月支出表示（上部）
- **支出総額**: 大きく表示
- **予算プログレスバー**: 
  - 緑（0-70%）
  - 黄色（70-90%） 
  - オレンジ（90-100%）
  - 赤（100%超）
- **残予算**: 「あと ¥XX,XXX」
- **アラート表示**: 閾値超過時に警告

#### 取引入力（下部）
- **テンキーパッド**: 数字入力
- **カテゴリ選択**: ドロップダウン
- **メモ欄**: オプション
- **保存ボタン**: 大きく目立つ

#### 予算超過時の表示
```
│  🔴 予算超過！         │
│  今月の予算を         │
│  ¥3,450超過しています │
```